!function(e,t){function o(t,o){var i=this;i.o=e.extend({},l,o),i.e=e(t),i.init()}var i="collapser",l={target:"next",mode:"words",speed:"slow",truncate:10,ellipsis:"...",effect:"fade",controlBtn:"",showText:"Show more",hideText:"Hide text",showClass:"show-class",hideClass:"hide-class",atStart:"hide",lockHide:!1,dynamic:!1,changeText:!1,beforeShow:null,afterShow:null,beforeHide:null,afterHide:null};o.prototype={init:function(){var o=this;o.mode=o.o.mode,o.remaining={},o.ctrlHtml=' <a href="#" data-ctrl class="'+(e.isFunction(o.o.controlBtn)?"":o.o.controlBtn)+'"></a>',e(o.e).each(function(){e(this).data("oCnt",o.e.html());var t=e.isFunction(o.o.atStart)?o.o.atStart.call(o.e):o.o.atStart;t="undefined"!=typeof o.e.attr("data-start")?o.e.attr("data-start"):t,"hide"==t?o.hide(o.e,0):o.show(o.e,0)});var i;e(t).on("resize",function(){o.o.dynamic&&"lines"==o.mode&&(clearTimeout(i),i=setTimeout(function(){o.reInit(o.e)},100))})},show:function(t,o){var i=this,l=e(t);"undefined"==typeof o&&(o=i.o.speed);var n=function(){e.isFunction(i.o.afterShow)&&i.o.afterShow.call(i.e,i)};switch(e.isFunction(i.o.beforeShow)&&i.o.beforeShow.call(i.e,i),i.mode){case"chars":case"words":var s=l.height();l.html(l.data("tHTML"));var c=l.height();l.height(s),l.animate({height:c},o,function(){l.height("auto"),n()}).removeClass(i.o.hideClass).addClass(i.o.showClass),l.data("tHTML",l.html());break;case"lines":0==l.children("div").length&&l.wrapInner("<div>");{var a=l.children("div"),r=a.height(),d=a.html(l.data("oCnt")).css("height","").height();a.css("height",r)}a.animate({height:d},o,function(){a.height("auto"),n()}),l.removeClass(i.o.hideClass).addClass(i.o.showClass);break;case"block":i.blockMode(l,"show",o,n)}return i.status=1,1==i.o.lockHide?(l.find("[data-ctrl]").remove(),""):void("block"==i.mode?l.off("click.coll").on("click.coll",function(e){e.preventDefault(),i.hide(l)}):(0!=l.find("[data-ctrl]").length||e.isFunction(i.o.controlBtn)||l.append(i.ctrlHtml),i.ctrlBtn=e.isFunction(i.o.controlBtn)?i.o.controlBtn.call(i.e):e(l.find("[data-ctrl]")),i.ctrlBtn.off("click.coll").on("click.coll",function(e){e.preventDefault(),i.hide(l)}).html(i.o.hideText)))},hide:function(t,o){var i=this,l=e(t);"undefined"==typeof o&&(o=i.o.speed);var n=function(){e.isFunction(i.o.afterHide)&&i.o.afterHide.call(i.e,i)};switch(e.isFunction(i.o.beforeHide)&&i.o.beforeHide.call(i.e,i),l.find("[data-ctrl]").remove(),i.mode){case"chars":var s=e.trim(l.text());i.remaining.chars=s.length-i.o.truncate,s.length>i.o.truncate&&(l.data("tHTML",l.html()),s=i.pad(s.slice(0,i.o.truncate),s.slice(i.o.truncate,s.length)),l.html(s).removeClass(i.o.showClass).addClass(i.o.hideClass),n());break;case"words":var s=e.trim(l.text()),c=s.split(" ");i.remaining.words=c.length-i.o.truncate,c.length>i.o.truncate&&(l.data("tHTML",l.html()),s=i.pad(c.slice(0,i.o.truncate).join(" "),c.slice(i.o.truncate,c.length).join(" ")),l.html(s).removeClass(i.o.showClass).addClass(i.o.hideClass),n());break;case"lines":0==l.children("div").length&&l.wrapInner("<div>");var a=l.children("div").css("height","");a.html(a.text());var r=a.height();"undefined"==typeof l.data("lHeight")?(temp=a.clone(),lHeight=temp.text("a").insertAfter(a).height(),l.data("lHeight",lHeight),a.next().remove()):lHeight=l.data("lHeight"),lines=r/lHeight,i.remaining.lines=lines-i.o.truncate,i.remaining.lines>0&&(a.css("overflow","hidden"),a.animate({height:lHeight*i.o.truncate},o).data("tHeight",r),l.removeClass(i.o.showClass).addClass(i.o.hideClass),0!=l.find("[data-ctrl]").length||e.isFunction(i.o.controlBtn)||l.append(i.ctrlHtml),n());break;case"block":i.blockMode(l,"hide",o,n)}if(i.status=0,"block"==i.mode)l.unbind("click.coll").bind("click.coll",function(e){e.preventDefault(),i.show(l)});else{i.ctrlBtn=e.isFunction(i.o.controlBtn)?i.o.controlBtn.call(i.e):e(l.find("[data-ctrl]")),i.ctrlBtn.off("click.coll").on("click.coll",function(e){e.preventDefault(),i.show(l)}).html(i.o.showText);var d=i.o.showText,m={chars:["character","characters"],words:["word","words"],lines:["lines","lines"]},h=i.remaining[i.mode]+(1==i.remaining[i.mode]?" "+m[i.mode][0]:" "+m[i.mode][1]);d=d.replace("%s",h),i.ctrlBtn.html(d)}},pad:function(t,o){var i=this;return t+'<span class="coll-ellipsis">'+i.o.ellipsis+"</span>"+(e.isFunction(i.o.ctrlBtn)?"":i.ctrlHtml)+'<span class="coll-hidden" style="display:none">'+o+"</span>"},blockMode:function(t,o,i,l){var n=this,s=["fadeOut","slideUp","fadeIn","slideDown"],c="fade"==n.o.effect?0:1,a="hide"==o?s[c]:s[c+2];e.isFunction(n.o.target)?n.o.target.call(n.e)[a](i,l):e.fn[n.o.target]&&e(t)[n.o.target]()[a](i,l),"show"==o?(t.removeClass(n.o.showClass).addClass(n.o.hideClass),n.o.changeText&&t.text(n.o.hideText)):(t.removeClass(n.o.hideClass).addClass(n.o.showClass),n.o.changeText&&t.text(n.o.showText))},reInit:function(e){var t=this;e.find("[data-ctrl]").remove(),e.html(t.e.data("oCnt")),0==t.status?t.hide(e,0):t.show(e,0)}},e.fn[i]=function(t){return this.each(function(){e.data(this,i)||e.data(this,i,new o(this,t))})}}(jQuery,window,document);var Demi={Models:{Course:{},Timeline:{},Week:{},Goal:{},Resource:{},Assignment:{}},Collections:{CoursesCollection:{},TimelinesCollection:{},WeeksCollection:{},GoalsCollection:{},ResourcesCollection:{},AssignmentsCollection:{}},Views:{WeekView:{},GoalView:{},ResourceView:{},AssignmentView:{},AppView:{}},Routers:{},models:{course:{},timeline:{},week:{},goal:{},resource:{},assignment:{}},collections:{coursesCollection:{},timelinesCollection:{},weeksCollection:{},goalsCollection:{},resourcesCollection:{},assignmentsCollection:{}},views:{weekView:{},goalView:{},resourceView:{},assignmentView:{},appView:{}},routers:{}};Demi.Models.Course=Backbone.Model.extend({idAttribute:"_id"}),Demi.Models.Timeline=Backbone.Model.extend({idAttribute:"_id"}),Demi.Models.Week=Backbone.Model.extend({idAttribute:"_id"}),Demi.Models.Goal=Backbone.Model.extend({idAttribute:"_id"}),Demi.Models.Resource=Backbone.Model.extend({idAttribute:"_id"}),Demi.Models.Assignment=Backbone.Model.extend({idAttribute:"_id"}),Demi.Collections.CourseCollection=Backbone.Collection.extend({model:Demi.Models.Course,url:"http://normalizer.herokuapp.com/courses"}),Demi.Collections.TimelineCollection=Backbone.Collection.extend({model:Demi.Models.Timeline,url:"http://normalizer.herokuapp.com/timelines"}),Demi.Collections.WeekCollection=Backbone.Collection.extend({model:Demi.Models.Week,url:"http://normalizer.herokuapp.com/weeks"}),Demi.Collections.GoalsCollection=Backbone.Collection.extend({model:Demi.Models.Goal,url:"http://normalizer.herokuapp.com/goals"}),Demi.Collections.ResourcesCollection=Backbone.Collection.extend({model:Demi.Models.Resource,url:"http://normalizer.herokuapp.com/resources"}),Demi.Collections.AssignmentsCollection=Backbone.Collection.extend({model:Demi.Models.Assignment,url:"http://normalizer.herokuapp.com/assignments"}),Demi.Views.GoalView=Backbone.View.extend({template:_.template($(".goal-template").html()),events:{"click .delete-button button":"destroy","click .edit-button button":"editGoal"},initialize:function(){this.listenTo(this.model,"destroy",this.remove),$(".goal-item").append(this.el),this.render(),this.model.isNew()&&(this.model.set({time:Date.now()}),this.model.save())},render:function(){var e=this.template(this.model.attributes);this.$el.html(e)},destroy:function(){this.model.destroy()}}),Demi.Views.ResourceView=Backbone.View.extend({template:_.template($(".resource-template").html()),events:{"click .delete-button button":"destroy","click .edit-button button":"editResource"},initialize:function(){this.listenTo(this.model,"destroy",this.remove),$(".resource-item").append(this.el),this.render(),this.model.isNew()&&(this.model.set({time:Date.now()}),this.model.save())},render:function(){var e=this.template(this.model.attributes);this.$el.html(e)},destroy:function(){this.model.destroy()}}),Demi.Views.AssignmentView=Backbone.View.extend({template:_.template($(".assignment-template").html()),events:{"click .delete-button button":"destroy","click .edit-button button":"editAssignment"},initialize:function(){this.listenTo(this.model,"destroy",this.remove),$(".assignment-item").append(this.el),this.render(),this.model.isNew()&&(this.model.set({time:Date.now()}),this.model.save())},render:function(){var e=this.template(this.model.attributes);this.$el.html(e)},destroy:function(){this.model.destroy()}}),Demi.Views.AppView=Backbone.View.extend({initialize:function(){Demi.collections.coursesCollection=new Demi.Collections.CoursesCollection,Demi.collections.timelinesCollection=new Demi.Collections.TimelinesCollection,Demi.collections.weeksCollection=new Demi.Collections.WeeksCollection,Demi.collections.goalsCollection=new Demi.Collections.GoalsCollection,Demi.collections.resourcesCollection=new Demi.Collections.ResourcesCollection,Demi.collections.assignmentsCollection=new Demi.Collections.AssignmentsCollection,Demi.collections.coursesCollection.fetch(),Demi.collections.timelinesCollection.fetch(),Demi.collections.weeksCollection.fetch(),Demi.collections.goalsCollection.fetch(),Demi.collections.resourcesCollection.fetch(),Demi.collections.assignmentsCollection.fetch(),this.listenTo(Demi.collections.coursesCollection,"add",function(){}),this.listenTo(Demi.collections.timelinesCollection,"add",function(){}),this.listenTo(Demi.collections.weeksCollection,"add",function(){}),this.listenTo(Demi.collections.goalsCollection,"add",function(){}),this.listenTo(Demi.collections.resourcesCollection,"add",function(){}),this.listenTo(Demi.collections.assignmentsCollection,"add",function(){})}}),new Demi.Views.AppView,$(document).ready(function(){$(".list p").collapser({mode:"lines",truncate:2,speed:"fast",effect:"fade",hideText:" Hide text"})}),$(".save-goal").click(function(){if(""!==$(".input-goal").val()){var e=$(".input-goal").val(),t=new Demi.Models.Goal({item:e});Demi.collections.goalsCollection.add(t),$(".input-goal").val("")}else alert("You must add a new goal before saving")}),$(".save-resource").click(function(){if(""!==$(".input-resource-url").val()&&""!==$(".input-resource-description").val()){var e=$(".input-resource-url").val(),t=$(".input-resource-description").val(),o=new Demi.Models.Resource({itemUrl:e,item:t});Demi.collections.resourcesCollection.add(o),$(".input-resource-url").val(""),$(".input-resource-description").val("")}else alert("You must add a new resource before saving")}),$(".save-assignment").click(function(){if(""!==$(".input-assignment").val()){var e=$(".input-assignment").val(),t=new Demi.Models.Assignment({item:e});Demi.collections.assignmentsCollection.add(t),$(".input-assignment").val("")}else alert("You must add a new assignment before saving")});